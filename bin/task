#!/bin/bash

. ./task-vars

TOTAL_TASK_PATHS=(${TASK_PATHS[@]} "./node_modules/task-library/src" "./node_modules/task-library/src/defaults" "./node_modules/task-library/src/lib")

function task() {
    TASK_NAME=$1
    for TASK_PATH in "${TOTAL_TASK_PATHS[@]}"; do [ -f "$TASK_PATH/$TASK_NAME" ] && TASK_FILE="$TASK_PATH/$TASK_NAME" && break; done
    echo "Task "$TASK_FILE" started"
    "$TASK_FILE" "${@:2}"
    EXIT_CODE=$?
    echo
    echo "Task "$TASK_FILE" completed with exit code $EXIT_CODE"
}

time task $@
echo
exit $EXIT_CODE
