#!/bin/bash

# Not yet sure how I could infer these:
# @node-loader/babel

function install {
    echo -n "Installing ${BOLD}$1${NORM}..."
    output=$(npm -D i $@ 2>&1)
    [ $? ] && echo " done" && return 0
    echo " error"
    echo "$output"
}

install "eslint" "husky"

if [ ! -z "$TEST_RUNNER" ]; then
    install "$TEST_RUNNER"
fi

if [ -f "$README_TEMPLATE" ]; then
    install "doctoc" "cloc"
fi

if [ -f "$SERVER" ]; then
    install "nodemon"
fi

if [ -f "$SERVERLESS_CONFIG" ]; then
    install "serverless" "aws-sdk"
fi

if has_any_dependency "react"; then
    install "@babel/core" "@babel/preset-react"
fi

if has_any_dependency "@babel/core"; then
    install "@babel/preset-env" "@babel/node"
fi

if has_any_dependency "react" && has_any_dependency "eslint"; then
    install "eslint-plugin-react"
fi

if has_any_dependency "jest"; then
    install "jest-environment-jsdom"
fi

if has_any_dependency "jest" && has_any_dependency "eslint"; then
    install "eslint-plugin-jest"
fi

if has_any_dependency "mocha" && has_any_dependency "eslint"; then
    install "eslint-plugin-mocha"
fi

if has_any_dependency "tap" && has_any_dependency "eslint"; then
    install "eslint-plugin-tap"
fi

if has_any_dependency "tape" && has_any_dependency "eslint"; then
    install "eslint-plugin-tape"
fi
